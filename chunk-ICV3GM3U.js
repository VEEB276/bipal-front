import{M as g,_ as p,b as f,c as v,d as P,t as E,v as s,y as D}from"./chunk-XJT5ECSK.js";import{C as t,G as d,aa as m,ea as u,ja as b,ka as a,n as c}from"./chunk-MOECM2J4.js";var l=class n{constructor(r){this.http=r}apiUrl=`${g.hojaDeVidaApiUrl}/persona`;httpOptions={headers:new f({"Content-Type":"application/json"})};auth=a(p);obtenerInformacionPersonal(r){return this.http.get(`${this.apiUrl}/find-by-id-persona/${r}`).pipe(t(this.handleError))}obtenerTodasLasPersonas(){return this.http.get(this.apiUrl).pipe(t(this.handleError))}crearInformacionPersonal(r){return this.http.post(`${this.apiUrl}/create-persona`,r,this.httpOptions).pipe(m(e=>{this.auth.updatePersonaId(e.id).then(()=>this.auth.getSession())}),t(this.handleError))}actualizarInformacionPersonal(r){return this.http.put(`${this.apiUrl}/actualizar-persona`,r,this.httpOptions).pipe(t(this.handleError))}eliminarInformacionPersonal(r){return this.http.delete(`${this.apiUrl}/${r}`).pipe(t(this.handleError))}buscarPorDocumento(r){return this.http.get(`${this.apiUrl}/find?numero-documento=${r}`).pipe(t(this.handleError))}validarDocumentoExistente(r){return this.http.get(`${this.apiUrl}/validar-documento/${r}`).pipe(t(this.handleError))}validarCorreoExistente(r){return this.http.get(`${this.apiUrl}/validar-correo/${encodeURIComponent(r)}`).pipe(t(this.handleError))}obtenerTiposDocumento(){return this.http.get(`${this.apiUrl}/search-all-tipo-documento`).pipe(t(this.handleError))}obtenerGeneros(){return this.http.get(`${this.apiUrl}/search-all-sexo`).pipe(t(this.handleError))}obtenerEnfoquesDiferenciales(){return this.http.get(`${this.apiUrl}/search-all-enfoque-diferencial`).pipe(t(this.handleError))}buscarDepartamentosMunicipios(r){let e=new v;return r&&(e=e.set("query",r)),this.http.get(`${this.apiUrl}/search-all-departamento-municipio`,{params:e}).pipe(t(this.handleError))}handleError(r){let e="Ha ocurrido un error inesperado";if(r.error instanceof ErrorEvent)e=`Error: ${r.error.message}`;else switch(r.status){case 400:e="Datos inv\xE1lidos. Por favor, revise la informaci\xF3n ingresada.";break;case 401:e="No tiene autorizaci\xF3n para realizar esta acci\xF3n.";break;case 404:e="La informaci\xF3n solicitada no fue encontrada.";break;case 409:e="Ya existe un registro con estos datos.";break;case 500:e="Error interno del servidor. Intente m\xE1s tarde.";break;default:e=`Error ${r.status}: ${r.message}`}return console.error("Error en InformacionPersonalService:",r),c(()=>new Error(e))}static \u0275fac=function(e){return new(e||n)(b(P))};static \u0275prov=u({token:n,factory:n.\u0275fac,providedIn:"root"})};var B=()=>{let n=a(p),r=a(l),e=a(E),i=n.session?.user.user_metadata.idPersona;if(!i)return!0;let h=!1;return e.select(D).pipe(d(1)).subscribe(o=>{h=!!o&&o.id===i}),h||(e.dispatch(s.loadPersona({id:i})),r.obtenerInformacionPersonal(i).subscribe({next:o=>e.dispatch(s.loadPersonaSuccess({persona:o})),error:o=>e.dispatch(s.loadPersonaFailure({error:o.message||"Error cargando persona"}))})),!0};export{l as a,B as b};
